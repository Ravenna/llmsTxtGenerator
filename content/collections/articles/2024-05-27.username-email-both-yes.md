---
id: bb298e65-b916-4867-ab8a-294f7338a577
blueprint: article
title: 'Username? Email? Both? Yes!'
author: 1d1068ab-208d-480d-a677-dda65fe0f490
categories:
  - development
  - project-planning
tags:
  - laravel
  - code
  - tutorial
thumbnail: laravel-php-framework-for-replacing-legacy-systems.webp
seo:
  title: '@seo:title'
  description: 'Use Laravel conventions to allow for usernames or email addresses in your authentication'
  image: '@seo:social_share_image'
updated_by: 1d1068ab-208d-480d-a677-dda65fe0f490
updated_at: 1717084450
content:
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'People need to be able to log in to your application, right? Of course! And sometimes, people don’t want to log in via a 3rd party source like Google or Facebook. As much as we might not want to do it, supporting user name and password logins is still a requirement for web apps today (and frankly, that might be a good thing, considering the power big tech companies already leverage over the internet).'
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'Those who use Laravel (top-tier people, if you ask me) might be aware of starter kits like Laravel Breeze and Jetstream, which provide you with authentication pages and functionality out of the gate. These are great, but their boilerplate only contains authentication logic for using someone’s email. What if people want to use a username? Yes, they are out there. And we want to give the people what they want, right?'
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'We can roll our own authentication logic to implement both username and email login, or we can modify what happens with Breeze or Jetstream. Let’s look at rolling our own first. And really, all we are doing is providing a route and a login function. You can do this with a controller if you like. For simplicity, let’s make it an anonymous function:'
  -
    type: set
    attrs:
      id: lwtfaw2g
      values:
        type: code
        inline_code:
          code: |-
            Route::post('/login', function(Request $request) {
               $credentials = $request->validate([
            	   'email_or_username' => 'required',
            	   'password' => 'required|(other good pass requirements)'
               ]);
            })
          mode: php
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'Alright, breaking this down. Under the hood, the auth methods provided by Breeze or Jetstream expect email to be passed in the request. But our application expects either and just needs the field to be required. And that can be tricky! We first need to figure out what we are working with here. We could use regex, but I am always wary of rolling my own regex when validating emails. It may be a case of being able to pass the blame, but if I am using a framework, I want to rely on what is good enough for the framework. Thankfully, Laravel provides methods to validate an email on demand like it would under the hood by '
      -
        type: text
        marks:
          -
            type: link
            attrs:
              href: 'https://laravel.com/docs/11.x/validation#manually-creating-validators'
              rel: null
              target: null
              title: null
          -
            type: underline
        text: 'letting us create validators'
      -
        type: text
        text: .
  -
    type: set
    attrs:
      id: lwtfbi0p
      values:
        type: code
        inline_code:
          code: |-
            $emailValidator = Validator::make($credentials, [
            	'email_or_username' => 'email'
            ]);

            $type = $emailValidator->fails() ? 'username' : 'email';
          mode: php
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'Since we know we have an email or username field in this validator, we only need to check if it passes the email test. If it doesn’t, we know we have a username! Next, we can use the Auth facade to attempt to authenticate a user with the given type and value:'
  -
    type: set
    attrs:
      id: lwtfbs7i
      values:
        type: code
        inline_code:
          code: |-
            $authenticated = Auth::attempt([

            	$type => $credentials['email_or_username'],
            	'password' => $credentials['$password']
            ]);

            return $authenticated ? redirect('/loggedin') : redirect(back()->withErrors([...]));
          mode: php
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'This is a simplified version of how to handle someone logged in versus a failed attempt. However, the principle of handling either a username or a password can apply to any scenario. To require either, use a validator to test for one, then use the auth facade to authenticate with whichever type is appropriate. Easy peasy!'
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'The process is fairly simple if you are already using Breeze or Jetstream and want to use either email or username. It’s a little more complicated for Jetstream, but not much. You must use the '
      -
        type: text
        marks:
          -
            type: code
        text: 'Fortify::authenticateUsing'
      -
        type: text
        text: ' method and call it in your Jetstream service provider. This method receives the request as a parameter like any routing method, so we can use the exact same code and logic for authenticating, except you will want to return the logged-in user instead of a response. More info can be found '
      -
        type: text
        marks:
          -
            type: link
            attrs:
              href: 'https://jetstream.laravel.com/features/authentication.html#customizing-user-authentication'
              rel: null
              target: null
              title: null
          -
            type: underline
        text: 'in the official documentation'
      -
        type: text
        text: .
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'For breeze, the controllers you would use to log in as a user are readily available! Just modify '
      -
        type: text
        marks:
          -
            type: code
        text: App\Http\Requests\Auth\LoginRequest.php
      -
        type: text
        text: ' with the logic for accepting email or username. Of course, you must modify the views used to pass the login request for both of these solutions.'
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: text
        text: 'Let people use a username or email to log in, whichever they prefer. Thankfully, Laravel makes it very easy!'
  -
    type: paragraph
    attrs:
      class: null
    content:
      -
        type: hardBreak
---
